(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();const y=document.getElementById("mazeCanvas"),c=y.getContext("2d"),a=20,d=20,n=25;y.width=d*n;y.height=a*n;let p=[],l={x:0,y:0};const g={x:d-1,y:a-1};let w=!1;const x=new Image;x.src="/assets/lv1.png";x.onload=()=>{c.drawImage(x,l.x,l.y,n,n)};function A(){const e=Array.from({length:a},()=>Array(d).fill(1)),r=Array.from({length:a},()=>Array(d).fill(!1));function i(t){return t.sort(()=>Math.random()-.5)}function s(t,o){r[o][t]=!0,e[o][t]=0;const u=i([{dx:0,dy:-1},{dx:1,dy:0},{dx:0,dy:1},{dx:-1,dy:0}]);for(const{dx:b,dy:k}of u){const m=t+b*2,h=o+k*2;m>=0&&m<d&&h>=0&&h<a&&!r[h][m]&&(e[o+k][t+b]=0,s(m,h))}}return s(0,0),e[a-1][d-1]=0,e[a-1][d-2]=0,e[a-2][d-1]=0,e}function v(){c.clearRect(0,0,y.width,y.height);for(let e=0;e<a;e++)for(let r=0;r<d;r++)r===g.x&&e===g.y?c.fillStyle="gold":p[e][r]===1?c.fillStyle="black":c.fillStyle="white",c.fillRect(r*n,e*n,n,n),c.strokeRect(r*n,e*n,n,n);c.drawImage(x,l.x*n+2,l.y*n+2,n-4,n-4)}function f(e,r){if(w)return;const i=l.x+e,s=l.y+r;i>=0&&i<d&&s>=0&&s<a&&p[s][i]===0&&(l.x=i,l.y=s),v(),L()}function L(){if(l.x===g.x&&l.y===g.y){w=!0,v();const e="ゴール！おめでとう！";c.font="30px Comic Sans MS";const r=c.measureText(e).width,i=(y.width-r)/2,s=y.height/2;c.fillStyle="yellow",c.fillRect(i-10,s-30,r+20,40),c.fillStyle="red",c.fillText(e,i,s)}}document.addEventListener("keydown",e=>{switch(e.key){case"ArrowUp":f(0,-1);break;case"ArrowDown":f(0,1);break;case"ArrowLeft":f(-1,0);break;case"ArrowRight":f(1,0);break}});document.getElementById("startBtn").addEventListener("click",()=>{p=A(),l={x:0,y:0},w=!1,v()});document.getElementById("retryBtn").addEventListener("click",()=>{p=A(),l={x:0,y:0},w=!1,v()});document.querySelectorAll(".dirBtn").forEach(e=>{e.addEventListener("click",()=>{switch(e.dataset.dir){case"up":f(0,-1);break;case"down":f(0,1);break;case"left":f(-1,0);break;case"right":f(1,0);break}})});
