(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const y of n.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&c(y)}).observe(document,{childList:!0,subtree:!0});function l(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(t){if(t.ep)return;t.ep=!0;const n=l(t);fetch(t.href,n)}})();const u=document.getElementById("mazeCanvas"),s=u.getContext("2d"),i=20,a=20,o=25;u.width=a*o;u.height=i*o;let x=[],d={x:0,y:0};const g={x:a-1,y:i-1};let p=!1;const k=new Image;k.src="/assets/lv1.png";function A(){const e=Array.from({length:i},()=>Array(a).fill(1)),r=Array.from({length:i},()=>Array(a).fill(!1));function l(t){return t.sort(()=>Math.random()-.5)}function c(t,n){r[n][t]=!0,e[n][t]=0;const y=l([{dx:0,dy:-1},{dx:1,dy:0},{dx:0,dy:1},{dx:-1,dy:0}]);for(const{dx:v,dy:b}of y){const m=t+v*2,h=n+b*2;m>=0&&m<a&&h>=0&&h<i&&!r[h][m]&&(e[n+b][t+v]=0,c(m,h))}}return c(0,0),e[i-1][a-1]=0,e[i-1][a-2]=0,e[i-2][a-1]=0,e}function w(){s.clearRect(0,0,u.width,u.height);for(let e=0;e<i;e++)for(let r=0;r<a;r++)r===g.x&&e===g.y?s.fillStyle="gold":x[e][r]===1?s.fillStyle="black":s.fillStyle="white",s.fillRect(r*o,e*o,o,o),s.strokeRect(r*o,e*o,o,o);s.drawImage(k,d.x*o+2,d.y*o+2,o-4,o-4)}function f(e,r){if(p)return;const l=d.x+e,c=d.y+r;l>=0&&l<a&&c>=0&&c<i&&x[c][l]===0&&(d.x=l,d.y=c),w(),L()}function L(){if(d.x===g.x&&d.y===g.y){p=!0,w();const e="ゴール！おめでとう！";s.font="30px Comic Sans MS";const r=s.measureText(e).width,l=(u.width-r)/2,c=u.height/2;s.fillStyle="yellow",s.fillRect(l-10,c-30,r+20,40),s.fillStyle="red",s.fillText(e,l,c)}}document.addEventListener("keydown",e=>{switch(e.key){case"ArrowUp":f(0,-1);break;case"ArrowDown":f(0,1);break;case"ArrowLeft":f(-1,0);break;case"ArrowRight":f(1,0);break}});document.getElementById("startBtn").addEventListener("click",()=>{x=A(),d={x:0,y:0},p=!1,w()});document.getElementById("retryBtn").addEventListener("click",()=>{x=A(),d={x:0,y:0},p=!1,w()});document.querySelectorAll(".dirBtn").forEach(e=>{e.addEventListener("click",()=>{switch(e.dataset.dir){case"up":f(0,-1);break;case"down":f(0,1);break;case"left":f(-1,0);break;case"right":f(1,0);break}})});
